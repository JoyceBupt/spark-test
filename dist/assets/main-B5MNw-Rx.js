import"./modulepreload-polyfill-B5Qt9EMX.js";import{S as w,P as m,W as f,R as p,V as u,C as y}from"./three.module-i82FoDp4.js";import{S as k,a as b}from"./spark.module-BSJ8aZ7e.js";const g=document.getElementById("spark-canvas"),r=new w,i=new m(75,window.innerWidth/window.innerHeight,.1,1e3);i.position.z=2;const t=new f({canvas:g,antialias:!1}),C=new k({canvas:g}),d=new p,a=new u;let e=null,l=!0;function h(){t.setPixelRatio(window.devicePixelRatio),t.setSize(window.innerWidth,window.innerHeight,!1),window.addEventListener("resize",E),window.addEventListener("click",v),document.getElementById("load56k").addEventListener("click",()=>c("/splats/model_56k.ply")),document.getElementById("load150k").addEventListener("click",()=>c("/splats/model_150k.ply")),document.getElementById("toggle-bg").addEventListener("click",L),document.getElementById("toggle-rotation").addEventListener("click",S),c("/splats/model_56k.ply"),t.setAnimationLoop(x),console.log("Spark 演示已初始化。您现在可以使用 DevTools 进行性能分析。")}function c(o){var n;e&&(r.remove(e),(n=e.dispose)==null||n.call(e)),e=new b({url:o}),e.position.set(0,0,-1),r.add(e),console.log(`开始加载模型: ${o}`),e.onLoad=()=>{console.log(`模型加载完成，Splat 数量: ${e.splatCount}`)}}function E(){i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight,!1)}function v(o){if(a.x=o.clientX/window.innerWidth*2-1,a.y=-(o.clientY/window.innerHeight)*2+1,d.setFromCamera(a,i),e){const n=d.intersectObject(e,!0);if(n.length>0){console.log("点击到了 SplatMesh!",{point:n[0].point,distance:n[0].distance});const s=document.getElementById("info-panel");s.style.transition="none",s.style.background="#00ff00",setTimeout(()=>{s.style.transition="background 0.5s",s.style.background="rgba(0,0,0,0.6)"},100)}else console.log("未点击到模型。")}}function L(){const o=t.getClearColor(new y),n=document.getElementById("info-panel");o.getHex()===1118481?(t.setClearColor(16777215),document.body.style.color="black",n.style.color="black",n.style.background="rgba(255,255,255,0.6)"):(t.setClearColor(1118481),document.body.style.color="white",n.style.color="white",n.style.background="rgba(0,0,0,0.6)")}function S(){l=!l,console.log(`模型自动旋转: ${l?"开启":"关闭"}`)}function x(){C.update(i),e&&l&&(e.rotation.y+=.005),t.render(r,i)}h();
