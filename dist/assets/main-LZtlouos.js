import{S as y,P as p,W as h,a as g}from"./spark.module-Cd71UaNH.js";const c=new y,d=new p(60,window.innerWidth/window.innerHeight,.1,1e3),i=new h;i.setSize(window.innerWidth,window.innerHeight);document.body.appendChild(i.domElement);const E="/splats/model_56k.ply",m=new g({url:E});m.position.set(0,0,-3);c.add(m);i.setAnimationLoop(function(t){i.render(c,d),m.rotation.y+=.01});let s=null,l=0;function C(){s=new PerformanceTester,s.setCallbacks((e,t)=>{B(e,t)},e=>{o(e)})}function B(e,t){const n=document.getElementById("progress-container"),r=document.getElementById("progress-fill"),a=document.getElementById("progress-text");if(e>0&&n.classList.add("visible"),r.style.width=`${Math.min(100,Math.max(0,e))}%`,a.textContent=t||`进度: ${e.toFixed(1)}%`,e>5&&l>0){const u=(Date.now()-l)/e*(100-e),w=Math.floor(u/6e4),f=Math.floor(u%6e4/1e3);document.getElementById("estimated-time").textContent=`${w}:${f.toString().padStart(2,"0")}`}}function o(e,t="info"){const n=document.getElementById("log-container"),r=document.createElement("div");r.className=`log-entry ${t}`,r.textContent=e,n.appendChild(r),n.scrollTop=n.scrollHeight;const a=n.children;a.length>20&&n.removeChild(a[0])}window.startPerformanceTest=async function(){s||C();const e=document.getElementById("start-test-btn"),t=document.getElementById("stop-test-btn");e.disabled=!0,e.classList.add("running"),e.textContent="测试进行中...",t.disabled=!1,document.getElementById("test-status").textContent="运行中",l=Date.now(),o("开始自动化性能测试...","success");try{await s.runFullTest(c,d,i,g),o("测试完成！结果文件已自动下载","success")}catch(n){o(`测试失败: ${n.message}`,"error")}finally{e.disabled=!1,e.classList.remove("running"),e.textContent="开始完整测试",t.disabled=!0,document.getElementById("test-status").textContent="完成",document.getElementById("progress-container").classList.remove("visible")}};window.stopPerformanceTest=function(){s&&(s.isRunning=!1,o("用户手动停止测试","info"))};window.toggleOverlay=function(){document.getElementById("performance-overlay").classList.toggle("minimized")};function b(){if(s){s.getStatus();const e=Object.keys(s.testResults.tests).length;document.getElementById("tested-models").textContent=`${e}/2`}}setInterval(b,1e3);window.addEventListener("resize",()=>{d.aspect=window.innerWidth/window.innerHeight,d.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)});o("3DGS 渲染器已加载","success");o('点击"开始完整测试"进行自动化性能分析',"info");
